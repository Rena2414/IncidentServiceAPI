# IncidentService

## Overview

This is a **Web API built with ASP.NET Core and Entity Framework Core (Code First)**. 
It supports the management of **Accounts, Contacts, and Incidents**, with business rules enforcing proper relationships between these entities.

### Key Features

**Accounts**
   - Each account must have **at least one contact** upon creation.
   - Account `Name` is unique and serves as a primary identifier.

**Contacts**
   - Each contact is linked to an account.
   - Contacts are **uniquely identified by their email address**.
   - When creating an account or incident:
     - If a contact with the same email exists, the contact is **updated** and linked to the account if not already linked.
     - Otherwise, a **new contact** is created automatically.

**Incidents**
   - Each incident is linked to exactly **one account**.
   - The primary key is a **string `IncidentName`**, autogenerated using a GUID.
   - Creating an incident automatically ensures the associated account exists and manages contact linking.

**Business Rules**
   - An **account cannot exist without at least one contact**.
   - An **incident cannot be created without an account**.

## Error Handling
The API utilizes Global Exception Middleware to return standardized HTTP status codes:
   - **200 OK / 201 Created:** Successful operations.
   - **400 Bad Request:** Validation failures (e.g., missing required fields)
   - **404 Not Found:** Operations referencing non-existent entities (e.g., creating an Incident for a missing Account)
   - **409 Conflict:** Attempts to create duplicate unique resources (e.g., duplicate Account Name)

## Testing
The project includes a comprehensive Unit Test suite (`IncidentServiceAPI.Tests`) using xUnit and Moq

